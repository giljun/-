# SQLD_관계

## 관계의 개념

### 관계의 정의

- 인스턴스 사이의 논리적인 연관성으로서 존재 또는 행위로서 서로에게 연관성이 부여된 상태



### 관계의 페어링

- 관계는 엔터티 안에 인스턴스가 개별적으로 관계를 가지는 것이고, 이것의 집합을 관계로 표현한다는 것
- 개별 인스턴스가 각각 다른 종류의 관계를 가지고 있다면 두 엔터티 사이에는 두 개 이상의 관계가 형성될 수 있다.



## 관계의 분류

- 존재에 의한 관계
  - '소속된다'라는 의미는 행위에 따른 이벤트에 의해 발생되는 의미가 아니다.
  - 존재의 형태에 의해 관계가 형성된 것
- 행위에 의한 관계
  - '주문한다'라는 행위에 의해 발생
  - 행위로부터 발생하였기 때문에 두 엔터티 사이의 관계는 행위에 의한 관계



## 관계의 표기법

- 관계명
  - 엔터티가 관계에 참여하는 형태를 지칭
  - 각각의 관계는 두 개의 관계명을 가지고 있다.
  - 각각의 관계명에 의해 두 가지의 관점으로 표현
  - 관계시작점
    - 관계가 시작되는 편
  - 관계끝점
    - 관계를 받는 편
  - 참여자의 관점에 따라 관계이름이 능동적, 수동적으로 명명
  - 애매한 동사를 피한다.
  - 현재형으로 표현
- 관계차수
  - 두 개의 엔터티간 관계에서 참여자의 수를 표현하는 것을 관계차수라고 한다.
  - 1:1
    - 두 개의 엔터티간 관계에서 참여자의 수를 표현하는 것을 관계차수라고 한다.
  - 1:M
    - 관계에 참여하는 각각의 엔터티는 관계를 맺는 다른 엔터티의 엔터티에 대해 하나나 그 이상의 수와 관계를 가지고 있다.
    - 반대의 방향은 하나만의 관계를 가지고 있다.
  - M:N
    - 양 쪽 모두 관계를 맺는 다른 엔터티의 엔터티에 대해 하나나 그 이상의 수와 관계를 가지고 있다.
    - 두 개의 주식별자를 상속받은 관계엔터티를 이용하여 3개의 엔터티로 구분하여 표현
- 관계선택사양
  - 필수참여관계
    - "반드시 지하철의 문이 닫혀야만 지하철은 출발한다." 지하철출발과 지하철문닫힘은 필수적으로 연결 관계가 있는 것.
    - 참여하는 모든 참여자가 반드시 관계를 가지는, 타 엔터티의 참여자와 연결이 되어야 하는 관계이다.
    - 필수참여로 지정하면 애플리케이션에서 데이터가 발생할 때 반드시 한 개의 트랜잭션으로 제어해야 하는 제약사항이 발생한다.
    - 아무런 표시도 하지 않는다.
  - 선택참여관계
    - 안내방송은 지하철의 출발과 상관없이 방송해도 아무런 문제가 발생하지 않는다. 물론 정해진 시간에 방송을 하면 승객에게 유익하긴 하다.
    - 물리속성에서 Foreign Key로 연결될 경우 Null을 허용할 수 있는 항목이 된다.
    - ERD에서 관계를 나타내는 선에서 선택참여하는 엔터티 쪽을 원으로 표시
  - 만약 관계가 표시된 양쪽 엔터티에 모두 선택참여가 표시된다면, 즉 0:0의 관계가 되는 것이고, 그 관계는 잘못될 확률이 많으므로 관계설정이 잘못되었는지를 검토



## 관계의 정의 및 읽는 방법

### 관계 체크사항

- 두 개의 엔터티 사이에서 관계를 정의할 때 다음 사항을 체크
  - 두 개의 엔터티 사이에 관심있는 연관규칙이 존재하는가?
  - 두 개의 엔터티 사이에 정보의 조합이 발생되는가?
  - 업무기술서, 장표에 관계연결에 대한 규칙이 서술되어 있는가?
  - 업무기술서, 장표에 관계연결을 가능하게 하는 동사가 있는가?



### 관계 읽기

- 데이터 모델을 읽는 방법은 먼저 관계에 참여하는 기준 엔터티를 하나 또는 각으로 읽는다.
- 대상 엔터티의 개수를 읽는다.
- 관계선택사양과 관계명을 읽는다.
  - 각각의 사원은 한 부서에 항상 속한다.
  - 각 부서에는 여러 사원이 때때로 소속된다.



